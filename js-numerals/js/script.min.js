function NumberToWords(){
	this.units = ["one", "two", "three", "four", "five", "six" , "seven", "eight", "nine"];
	this.teens = ["ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen"];
	this.tens = ["twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"];
	this.hundred = "hundred";
	this.biggest = ["thousand", "million", "billion", "trillion", "quadrillion", "quintillion", "sextillion", "septillion", "octillion", "nonillion", "decillion", "undecillion", "duodecillion", "tredecillion", "quatttuor-decillion", "quindecillion", "sexdecillion", "septen-decillion", "octodecillion", "novemdecillion", "vigintillion"];

	this.getUnits = function(number){
		return this.units[number-1]
	};

	this.getTens = function(number){
		var quo = Math.floor(number / 10);
		var rem = number % 10;
		return (quo > 1) ? `${this.tens[quo-2]}${rem > 0 ? "-" + this.getUnits(rem) : ""}`.trim() : this.teens[rem];
	};

	this.getHundreds = function(number){
		var quo = Math.floor(number / 100);
		var rem = number % 100;
		var hundred = "";
		hundred += quo > 0 ? `${this.getUnits(quo)} ${this.hundred}`: "";
		if(rem > 0){
			hundred += ` and ${rem > 10 ? this.getTens(rem) : this.getUnits(rem)}`
		}
		return hundred
	};

	this.getBiggest = function(array){
		var text = "";
		var c = 0;
		for(var i = array.length - 1; i > 0 ; i--){
			if(array[c]) text += `${array[c]} ${this.biggest[i-1]} `; 
			c++;
		}
		text += array[array.length - 1] ? array[array.length - 1] : "";
		return text.trim();
	}

	this.getBiggestSpecial = function(splitted){
		var array = [splitted[0]*10 + Math.floor(splitted[1] / 100), splitted[1] % 100];
		return `${this.baseTranslator(array[0])} ${this.hundred} ${array[1] > 0 ? "and " + this.baseTranslator(array[1]) : "" }`.trim();
	}

	this.splitNumber = function(number) {
		var array = [];
		var aux = "";
		var counter = 0;
		while(number > 0){
			aux = (number % 10).toString() + aux ;
			number = Math.floor(number / 10);
			counter++;
			if(counter == 3){
				array.push(parseInt(aux));
				aux = "";
				counter = 0;
			}
		}
		aux.length > 0 ? array.push(parseInt(aux)) : "";
		return array.reverse();
	}

	this.baseTranslator = function(number) {
		return (Math.floor(number / 10) < 1) ? this.getUnits(number) : (Math.floor(number / 100) < 1 ? this.getTens(number) : this.getHundreds(number))
	}

	this.translator = function(number){
		var splitted = this.splitNumber(number);
		console.log(splitted);
		var realThis = this;
		var toWords = "";
		var spaceSplit;
		if(splitted.length == 2 && splitted[0] < 2){
			toWords = this.getBiggestSpecial(splitted);	
		}else{
			toWords = this.getBiggest(splitted.map(function(e){
				return realThis.baseTranslator(e);
			}));
			if(splitted.length - 1 > 0 && splitted[splitted.length - 1] < 100 && splitted[splitted.length - 1] > 0){
				spaceSplit = toWords.split(" ");
				spaceSplit.splice(parseInt(spaceSplit.length)-1,0,"and");
				toWords = spaceSplit.join(" ");
			}
		}
		return toWords;
	}
}

function numberToWords(number){
	var ntw = new NumberToWords();
	return ntw.translator(number);	
}

if (typeof exports !== 'undefined') {
  exports.numberToWords = numberToWords;
}
document.addEventListener("DOMContentLoaded", function(event) { 
	var validateNumbers = function(e) {
		var event = e || window.event;
		var key = event.keyCode || event.which;
		var keyChar;
		var regex = /[0-9]|\./;
		keyChar = String.fromCharCode( key );
		if(key == 13){
			translateInput(e);
		}else if(key == 8){
			event.returnValue = true;
		}else if( !regex.test(keyChar) ) {
			event.returnValue = false;
			if(event.preventDefault) event.preventDefault();
		}
	};

	var translateInput = function(e){
		e.preventDefault();
		var number = document.getElementById("number");
		var words = document.getElementById("words");
		if(number.value != ""){
			var newH2 = document.createElement("h2");
			var numberText = numberToWords(number.value).toString();
			var newNumber = document.createTextNode(numberText);
			words.removeChild(words.lastChild);
			newH2.appendChild(newNumber);
			newH2.setAttribute("class", "reveal-text" );
			words.appendChild(newH2);
			number.value = "";
			toggleShow();
			fitText(numberText, newH2);		
		}
	};

	var fitText = function(text, el){
		var sizeStart = 12;
		while(el.offsetHeight < el.scrollHeight || el.offsetWidth < el.scrollWidth){
			sizeStart -= 0.2;
			el.style.fontSize = `${sizeStart}vw`; 
		}
	}
	var catchEscBackspace = function(e){
		var event = e || window.event;
		var key = event.keyCode || event.which;
		if(key == 27 || key == 8) toggleShow();
	};

	var toggleShow = function(){
		var words = document.getElementById("words");
		if(words.classList.contains('show')){
			document.querySelector("body").removeEventListener("keydown", catchEscBackspace);
		}else{
			document.querySelector("body").addEventListener("keydown", catchEscBackspace);
		}
		words.classList.toggle('show');
	};

	document.querySelector("#words .undo").addEventListener("click", toggleShow);
	document.getElementById("number").addEventListener("keypress", validateNumbers);
	document.getElementById("get-text").addEventListener("click", translateInput);
})